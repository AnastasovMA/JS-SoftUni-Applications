const formElement = document.querySelector('form');
const tbody = document.querySelector('tbody');
const baseURL = `http://localhost:3030/jsonstore/collections/books`;
const loadBtn = document.getElementById('loadBooks');

loadBtn.onclick();

async function getBooks(){
    const response = await fetch(baseURL);

    return await response.json();
}

function attachEvents(){
    formElement.addEventListener('submit', (e) => {
        e.preventDefault();

        let formData = new FormData(e.currentTarget);

        // let {title, author} = Object.fromEntries(formData);

        let title = formData.get('title')
        let author = formData.get('author')

        if (title === `` || author === '') {
            alert('fields must be filled');
            return;
        }
        let tRow = createElement('tr', '', tbody);
        let tdTtitle = createElement('td', `${title}`, tRow);
        let tdAuthor = createElement('td', `${author}`, tRow);
        let tdButtons = createElement('td', '', tRow)
        let editButton = createElement('button', 'Edit', tdButtons);
        let deleteButton = createElement('button', 'Delete', tdButtons);

        // editButton.addEventListener('click', EditBook);
        deleteButton.addEventListener('click', (e) => {
            let name = e.currentTarget.parentElement.parentElement.children[0];
            // console.log(getBooks());
        });

        let book = {
            author,
            title,
        }

        fetch(baseURL, {
            method: 'POST',
            headers: {
                'Content-type': 'application/json'
            },
            body: JSON.stringify(book)
        })

        formElement.reset();
    })
}

async function DeleteBook(){
}

function createElement(type, text, parent){
    const element = document.createElement(type);
    if (text) {
        element.textContent = text;
    }
    if (parent) {
        parent.appendChild(element);
    }
    return element;
}
attachEvents();